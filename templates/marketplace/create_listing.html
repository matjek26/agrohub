{% extends 'base.html' %}

{% block title %}Create Listing - Agrohub{% endblock %}

{% block content %}
<div class="bg-gray-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-white rounded-3xl shadow-2xl p-8">
            <div class="text-center mb-8">
                <div class="w-16 h-16 mx-auto bg-gradient-to-br from-accent-400 to-accent-500 rounded-full flex items-center justify-center mb-4">
                    <i class="fas fa-bullhorn text-gray-900 text-2xl"></i>
                </div>
                <h1 class="text-4xl font-bold text-gray-900 mb-2">Post Free Ad</h1>
                <p class="text-gray-600 text-lg">Reach thousands of potential buyers across Malaysia</p>
            </div>
            
            <form method="POST" enctype="multipart/form-data" class="space-y-6">
                {% csrf_token %}
                
                <!-- Category Selection -->
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-3">Category *</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        {% for category in categories %}
                        <label class="relative cursor-pointer">
                            <input type="radio" name="category" value="{{ category.id }}" required class="peer sr-only">
                            <div class="p-4 border-2 border-gray-300 rounded-xl peer-checked:border-primary-600 peer-checked:bg-primary-50 transition text-center hover:border-primary-400">
                                <i class="fas fa-seedling text-2xl mb-2 text-gray-600"></i>
                                <div class="font-semibold text-gray-700 text-sm">{{ category.display_name }}</div>
                            </div>
                        </label>
                        {% endfor %}
                    </div>
                </div>
                
                <hr class="border-gray-200">
                
                <!-- Title -->
                <div>
                    <label for="title" class="block text-sm font-bold text-gray-700 mb-2">Listing Title *</label>
                    <input type="text" 
                           id="title" 
                           name="title" 
                           required 
                           maxlength="200"
                           class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                           placeholder="E.g., Fresh Tilapia Fish - Quality Grade A">
                    <p class="text-sm text-gray-500 mt-1">Be specific and descriptive</p>
                </div>
                
                <!-- Description -->
                <div>
                    <label for="description" class="block text-sm font-bold text-gray-700 mb-2">Description *</label>
                    <textarea id="description" 
                              name="description" 
                              required 
                              rows="6"
                              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                              placeholder="Describe your product in detail..."></textarea>
                    <p class="text-sm text-gray-500 mt-1">Include specifications, condition, and any other relevant details</p>
                </div>
                
                <!-- Price -->
                <div>
                    <label for="price" class="block text-sm font-bold text-gray-700 mb-2">Price (RM) *</label>
                    <div class="relative">
                        <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-600 font-bold">RM</span>
                        <input type="number" 
                               id="price" 
                               name="price" 
                               required 
                               step="0.01"
                               min="0"
                               class="w-full pl-16 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                               placeholder="0.00">
                    </div>
                </div>
                
                <!-- Availability Months -->
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-3">
                        Bulan Availability / Available Months
                        <span class="text-gray-500 font-normal text-xs">(Pilih bila produk anda available)</span>
                    </label>
                    
                    <!-- Always Available Option -->
                    <div class="mb-4">
                        <label class="flex items-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer hover:border-primary-500 transition">
                            <input type="checkbox" 
                                   id="always_available" 
                                   name="always_available" 
                                   value="always"
                                   class="w-5 h-5 text-primary-600 border-gray-300 rounded focus:ring-primary-500"
                                   onchange="toggleMonthSelection(this)">
                            <span class="ml-3 text-gray-700 font-semibold">
                                <i class="fas fa-infinity text-primary-600 mr-2"></i>Sentiasa Ada (Year-round availability)
                            </span>
                        </label>
                    </div>
                    
                    <!-- Month Selection -->
                    <div id="month-selection" class="grid grid-cols-3 md:grid-cols-4 gap-3">
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="1" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Januari</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="2" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Februari</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="3" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Mac</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="4" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">April</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="5" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Mei</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="6" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Jun</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="7" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Julai</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="8" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Ogos</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="9" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">September</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="10" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Oktober</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="11" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">November</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="checkbox" name="months" value="12" class="peer sr-only month-checkbox">
                            <div class="p-3 text-center border-2 border-gray-300 rounded-lg peer-checked:border-primary-600 peer-checked:bg-primary-50 hover:border-primary-400 transition">
                                <div class="font-semibold text-sm">Disember</div>
                            </div>
                        </label>
                    </div>
                    <p class="text-sm text-gray-500 mt-2">
                        <i class="fas fa-calendar-alt mr-1"></i>Pilih bulan bila produk anda ready untuk dijual
                    </p>
                </div>
                
                <!-- Location -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="state" class="block text-sm font-bold text-gray-700 mb-2">State *</label>
                        <select id="state" 
                                name="state" 
                                required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            <option value="">Select State</option>
                            <option value="johor">Johor</option>
                            <option value="kedah">Kedah</option>
                            <option value="kelantan">Kelantan</option>
                            <option value="melaka">Melaka</option>
                            <option value="negeri_sembilan">Negeri Sembilan</option>
                            <option value="pahang">Pahang</option>
                            <option value="penang">Penang</option>
                            <option value="perak">Perak</option>
                            <option value="perlis">Perlis</option>
                            <option value="sabah">Sabah</option>
                            <option value="sarawak">Sarawak</option>
                            <option value="selangor">Selangor</option>
                            <option value="terengganu">Terengganu</option>
                            <option value="kuala_lumpur">Kuala Lumpur</option>
                            <option value="labuan">Labuan</option>
                            <option value="putrajaya">Putrajaya</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="district" class="block text-sm font-bold text-gray-700 mb-2">District/Area *</label>
                        <input type="text" 
                               id="district" 
                               name="district" 
                               required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                               placeholder="E.g., Johor Bahru">
                    </div>
                </div>
                
                <!-- Images -->
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-3">Product Images *</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="image1" class="block cursor-pointer">
                                <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-primary-500 transition">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                                    <p class="text-sm text-gray-600 font-semibold">Main Image *</p>
                                    <p class="text-xs text-gray-500 mt-1">Click to upload</p>
                                </div>
                            </label>
                            <input type="file" 
                                   id="image1" 
                                   name="image1" 
                                   accept="image/*" 
                                   required 
                                   class="hidden">
                        </div>
                        
                        <div>
                            <label for="image2" class="block cursor-pointer">
                                <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-primary-500 transition">
                                    <i class="fas fa-image text-4xl text-gray-400 mb-2"></i>
                                    <p class="text-sm text-gray-600 font-semibold">Additional Image</p>
                                    <p class="text-xs text-gray-500 mt-1">Optional</p>
                                </div>
                            </label>
                            <input type="file" 
                                   id="image2" 
                                   name="image2" 
                                   accept="image/*" 
                                   class="hidden">
                        </div>
                    </div>
                    <p class="text-sm text-gray-500 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>Upload clear photos for better visibility
                    </p>
                </div>
                
                <hr class="border-gray-200">
                
                <!-- Terms -->
                <div class="bg-primary-50 rounded-xl p-6">
                    <div class="flex items-start">
                        <input type="checkbox" required class="mt-1 rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                        <div class="ml-3">
                            <p class="text-sm text-gray-700">
                                I confirm that this listing complies with Agrohub's <a href="#" class="text-primary-600 font-semibold hover:underline">Terms of Service</a> and that all information provided is accurate.
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-accent-400 to-accent-500 hover:from-accent-500 hover:to-accent-600 text-gray-900 font-bold py-4 rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105">
                        <i class="fas fa-check-circle mr-2"></i>Post Listing
                    </button>
                    <a href="{% url 'home' %}" class="px-8 py-4 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold rounded-xl transition text-center">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function toggleMonthSelection(checkbox) {
    const monthSelection = document.getElementById('month-selection');
    const monthCheckboxes = document.querySelectorAll('.month-checkbox');
    
    if (checkbox.checked) {
        // Disable month selection
        monthSelection.style.opacity = '0.5';
        monthSelection.style.pointerEvents = 'none';
        monthCheckboxes.forEach(cb => {
            cb.checked = false;
            cb.disabled = true;
        });
    } else {
        // Enable month selection
        monthSelection.style.opacity = '1';
        monthSelection.style.pointerEvents = 'auto';
        monthCheckboxes.forEach(cb => {
            cb.disabled = false;
        });
    }
}
</script>
{% endblock %}
